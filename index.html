<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title>AR-test</title>

    <script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script>
    <script src='https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar-nft.js'></script>

    <style>
        body { margin: 0; overflow: hidden; }
        /* GPSの状況を表示するステータスバー */
        #status {
            position: absolute; top: 0; left: 0; width: 100%;
            background: rgba(0,0,0,0.7); color: lime;
            padding: 10px; text-align: center; font-family: sans-serif; z-index: 99;
        }
    </style>
</head>

<body>
    <div id="status">GPS信号を待機中... (屋外に出て空を見上げてください)</div>

    <a-scene
        vr-mode-ui="enabled: false"
        embedded
        arjs='sourceType: webcam; videoTexture: true; debugUIEnabled: false;'
        renderer="antialias: true; alpha: true; precision: medium;">

        <a-camera gps-camera="gpsMinDistance: 5" rotation-reader></a-camera>

        <a-entity
            gps-entity-place="latitude: 35.3606; longitude: 138.7274;"
            gltf-model="url(./assets/fuji.glb)"
            scale="500 500 500"
            position="0 200 0">
        </a-entity>
        <a-entity
            gps-entity-place="latitude: 34.6851; longitude: 135.8398;"
            gltf-model="url(./assets/ra.glb)"
            scale="300 300 300"
            position="0 100 0">
        </a-entity>

        <a-entity gps-entity-place="latitude: 35.3606; longitude: 138.7274;">
             <a-box color="red" scale="100 100 100" position="0 500 0"></a-box>
        </a-entity>

    </a-scene>

    <script>
        // GPSが最初に認識されたらステータスを変更するだけの単純なスクリプト
        window.addEventListener('gps-camera-update-position', function(e) {
            const status = document.getElementById('status');
            if (status.innerText.includes('待機中')) {
                status.innerText = "GPS認識成功！周囲を見回してください。(特に空の方角)";
                status.style.color = "white";
            }
        }, { once: true }); // 一度だけ実行
    </script>
</body>
</html>